.errors
  - @commit.errors.full_messages.each do |message|
    .error.notice= message

.heading
  h5 title= @dataset.geo_id
    = @dataset.area.humanize

= render 'shared/flash', flash: flash

.edit-form
  .content
    | You changed the following attributes:

    - @filter.changed_edits.each do |edit|
      .edit
        span.key>
          = I18n.t("activerecord.attributes.dataset_edit.#{ edit.key }")

        span.to> to
        span.val= edit.value
        span.unit= edit.unit

    .attributes
      = form_for [dataset, commit], as: :change, url: dataset_commits_path(dataset.geo_id), remote: true do |form|
        = form.hidden_field :dataset_id, value: dataset.id
        = form.fields_for(:dataset_edits) do |d|
          - if @filter.include?(d.object.key)
            = d.hidden_field :key, value: d.object.key
            = d.hidden_field :value, value: d.object.value

        .field
          = form.label :message, "Reason for changes"
          = form.text_area :message, maxlength: 500

        = form.fields_for(:source) do |s|
          .field.file
            = s.file_field :source_file
            = s.label :source_file do
              => I18n.t("datasets.attributes.source_file")
              i.fa.fa-upload
              span= filename_for_source

        .field
          = form.submit "Save"
          span.or or
          = link_to "Cancel", new_dataset_commit_path(dataset.geo_id, format: :js), remote: true, class: "button"
